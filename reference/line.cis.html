<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Slope and elevation of a (standardised) major axis, with confidence
intervals — line.cis • smatr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Slope and elevation of a (standardised) major axis, with confidence
intervals — line.cis"><meta property="og:description" content="Calculates the slope and elevation of a major axis or standardised major
axis, and constructs confidence intervals for the true slope and elevation.
This can now be fitted via calls of the form sma(y~x, ...), see
sma."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.4-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/smatr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/traitecoevo/smatr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Slope and elevation of a (standardised) major axis, with confidence
intervals</h1>
    <small class="dont-index">Source: <a href="https://github.com/traitecoevo/smatr/blob/HEAD/R/line.cis.R" class="external-link"><code>R/line.cis.R</code></a></small>
    <div class="hidden name"><code>line.cis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the slope and elevation of a major axis or standardised major
axis, and constructs confidence intervals for the true slope and elevation.
This can now be fitted via calls of the form <code>sma(y~x, ...)</code>, see
<code><a href="sma.html">sma</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">line.cis</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"SMA"</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  f.crit <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>The Y-variable</p></dd>


<dt>x</dt>
<dd><p>The X-variable</p></dd>


<dt>alpha</dt>
<dd><p>The desired confidence level for the 100(1-alpha)% confidence
interval for the common slope. (Default value is 0.05, which returns a 95%
confidence interval.)</p></dd>


<dt>data</dt>
<dd><p>Deprecated. Use with() instead (see Examples).</p></dd>


<dt>method</dt>
<dd><p>The line fitting method:</p><dl><dt>'OLS' or 0</dt>
<dd><p>linear
regression</p></dd>
 <dt>'SMA' or 1</dt>
<dd><p>standardised major axis (this is the default)</p></dd>

<dt>'MA' or 2</dt>
<dd><p>major axis</p></dd>
 
</dl></dd>


<dt>intercept</dt>
<dd><p>(logical) Whether or not the line includes an intercept.</p><dl><dt>FALSE</dt>
<dd><p>no intercept, so the line is forced through the
origin</p></dd>
 <dt>TRUE</dt>
<dd><p>an intercept is fitted (this is the default)</p></dd>
 
</dl></dd>


<dt>V</dt>
<dd><p>The estimated variance matrix of measurement error. Average
measurement error for Y is in the first row and column, and average
measurement error for X is in the second row and column. The default is that
there is no measurement error.</p></dd>


<dt>f.crit</dt>
<dd><p>(optional - rarely required). The critical value to be used
from the F distribution. (Only actually useful for reducing computation time
in simulation work - otherwise, do not change.)</p></dd>


<dt>robust</dt>
<dd><p>If TRUE, uses a robust method to fit the lines and construct
confidence intervals.</p></dd>


<dt>...</dt>
<dd><p>Further parameters (not passed anywhere at the moment).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>coeff</dt>
<dd><p>A matrix containing the estimated elevation and slope
(first column), and the lower and upper limits of confidence intervals for
the true elevation and slope (second and third columns). Output for the
elevation and slope are in the first and second rows, respectively.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Fits a linear regression line, major axis, or standardised major axis, to a
bivariate dataset. The slope and elevation are returned with confidence
intervals, using any user-specified confidence level.</p>
<p>Confidence intervals are constructed by inverting the standard one-sample
tests for elvation and slope (see slope.test and elev.test for more
details). Only the primary confidence interval is returned - this is valid
as long as it is known a priori that the (standardised) major axis is
estimating the true slope rather than the (standardised) minor axis. For
SMA, this means that the sign of the true slope needs to be known a priori,
and the sample slope must have the same sign as the true slope.</p>
<p>The test assumes the following:</p><ol><li><p>y and x are linearly
related</p></li>
<li><p>residuals independently follow a normal distribution with
equal variance at all points along the line</p></li>
</ol><p>These assumptions can be visually checked by plotting residuals against
fitted axis scores, and by constructing a Q-Q plot of residuals against a
normal distribution.  An appropriate residual variable is y-bx, and for
fitted axis scores use x (for linear regression), y+bx (for SMA) or by+x
(for MA), where b represents the estimated slope.</p>
<p>If measurement error is present, it can be corrected for through use of the
input argument V, which makes adjustments to the estimated sample variances
and covariances then proceeds with the same method of inference. Note,
however, that this method is only approximate (see Warton et al in review
for more details).</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and
modifies confidence interval formulae along the lines discussed in Taskinen
&amp; Warton (in review).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Warton, D.I., I.J. Wright, D.S. Falster and M. Westoby. 2006.
Bivariate line-fitting methods for allometry. <em>Biological Reviews</em>
<b>81</b>, 259--291.</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more
allometric lines.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sma.html">sma</a></code>, <code><a href="slope.test.html">slope.test</a></code>,
<code><a href="elev.test.html">elev.test</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S.
Taskinen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#load the leaflife data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">leaflife</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#consider only the low rainfall sites:</span></span></span>
<span class="r-in"><span><span class="va">leaf.low.rain</span><span class="op">=</span><span class="va">leaflife</span><span class="op">[</span><span class="va">leaflife</span><span class="op">$</span><span class="va">rain</span><span class="op">==</span><span class="st">'low'</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#estimate the SMA line for reserve vs coat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">leaf.low.rain</span>, <span class="fu">line.cis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">longev</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">lma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           coef(SMA) lower limit upper limit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elevation -2.822586   -3.387011   -2.258162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> slope      1.323612    1.095732    1.598883</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#produce CI's for MA slope and elevation:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">leaf.low.rain</span>, <span class="fu">line.cis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">longev</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">lma</span><span class="op">)</span>,method<span class="op">=</span><span class="st">'MA'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            coef(MA) lower limit upper limit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elevation -2.962207   -3.652955   -2.271458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> slope      1.386042    1.114518    1.751817</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Warton, Remko Duursma, Daniel Falster, Sara Taskinen, Fonti Kar.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

