<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>One-sample test of a (standardised) major axis slope — slope.test • smatr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="One-sample test of a (standardised) major axis slope — slope.test"><meta property="og:description" content="Test if the slope of a major axis or standardised major axis equals a
specific value. This can now be done via sma(y~x, slope.test=1), see
help on sma."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.4-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/smatr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/traitecoevo/smatr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>One-sample test of a (standardised) major axis slope</h1>
    <small class="dont-index">Source: <a href="https://github.com/traitecoevo/smatr/blob/HEAD/R/slope.test.R" class="external-link"><code>R/slope.test.R</code></a></small>
    <div class="hidden name"><code>slope.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test if the slope of a major axis or standardised major axis equals a
specific value. This can now be done via <code>sma(y~x, slope.test=1)</code>, see
help on <code><a href="sma.html">sma</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">slope.test</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  test.value <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"SMA"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>The Y-variable</p></dd>


<dt>x</dt>
<dd><p>The X-variable</p></dd>


<dt>test.value</dt>
<dd><p>The hypothesised value of the slope (default value is 1)</p></dd>


<dt>data</dt>
<dd><p>Deprecated. Use with() instead (see Examples).</p></dd>


<dt>method</dt>
<dd><p>The line fitting method:</p><dl><dt>'OLS' or 0</dt>
<dd><p>linear
regression</p></dd>
 <dt>'SMA' or 1</dt>
<dd><p>standardised major axis (this is the default)</p></dd>

<dt>'MA' or 2</dt>
<dd><p>major axis</p></dd>
 
</dl></dd>


<dt>alpha</dt>
<dd><p>The desired confidence level for the 100(1-alpha)% confidence
interval for the common slope. (Default value is 0.05, which returns a 95%
confidence interval.)</p></dd>


<dt>V</dt>
<dd><p>The estimated variance matrix of measurement error. Average
measurement error for Y is in the first row and column, and average
measurement error for X is in the second row and column. The default is that
there is no measurement error.</p></dd>


<dt>intercept</dt>
<dd><p>(logical) Whether or not the line includes an intercept.</p><dl><dt>FALSE</dt>
<dd><p>no intercept, so the line is forced through the
origin</p></dd>
 <dt>TRUE</dt>
<dd><p>an intercept is fitted (this is the default)</p></dd>
 
</dl></dd>


<dt>robust</dt>
<dd><p>If TRUE, uses a robust method to fit the lines and construct
the test statistic.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>r</dt>
<dd><p>The test statistic - the sample correlation between
residuals and fitted values</p></dd>


<dt>p</dt>
<dd><p>The P-value, taken from the F-distribution. This is an exact test
if residuals are normally distributed.</p></dd>


<dt>test.value</dt>
<dd><p>The hypothesised value of the slope</p></dd>


<dt>b</dt>
<dd><p>The estimated slope</p></dd>


<dt>ci</dt>
<dd><p>A 100(1-alpha)% CI for the slope.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Tests if the line relating y to x has a slope equal to test.value (which has
a default value of 1). The line can be a linear regression line, major axis
or standardised major axis (as selected using the input argument choice).
The test is carried out by testing for correlation between residual and
fitted values, as described in Warton et al (in review).</p>
<p>A confidence interval for the slope is also returned, which is the primary
confidence interval found by inverting the one-sample test statistic.</p>
<p>If measurement error is present, it can be corrected for through use of the
input argument V, which makes adjustments to the estimated sample variances
and covariances then proceeds with the same method of inference. Note,
however, that this method is only approximate (see Warton et al in review
for more details).</p>
<p>The test assumes the following:</p><ol><li><p>y and x are linearly
related</p></li>
<li><p>residuals independently follow a normal distribution with
equal variance at all points along the line</p></li>
</ol><p>The assumptions can be visually checked by plotting residual scores against
fitted axis scores, and by constructing a Q-Q plot of residuals against a
normal distribution, available using the <code><a href="plot.sma.html">plot.sma</a></code> function.</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and
modifies the test statistic as proposed in Taskinen &amp; Warton (in review).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of
bivariate line-fitting methods for allometry.  <em>Biological Reviews</em>
<b>81</b>, 259--291.</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more
allometric lines.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sma.html">sma</a></code>, <code><a href="line.cis.html">line.cis</a></code>, <code><a href="elev.test.html">elev.test</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S.
Taskinen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#load the leaflife dataset:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">leaflife</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#consider only the low rainfall sites:</span></span></span>
<span class="r-in"><span><span class="va">leaf.low.rain</span> <span class="op">&lt;-</span> <span class="va">leaflife</span><span class="op">[</span><span class="va">leaflife</span><span class="op">$</span><span class="va">rain</span><span class="op">==</span><span class="st">'low'</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#test if the SMA slope amongst species at low rainfall sites is 1,</span></span></span>
<span class="r-in"><span><span class="co">#for log (base 10) transformed data:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">leaf.low.rain</span>, <span class="fu">slope.test</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">longev</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">lma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.29037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4801931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.004680958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $test.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.323612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.095732 1.598883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="co">#test if the MA slope is 2/3</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">leaf.low.rain</span>, <span class="fu">slope.test</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">longev</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">lma</span><span class="op">)</span>, test.value <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, method <span class="op">=</span> <span class="st">'MA'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 40.21607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7514686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.659633e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $test.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.386042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.114518 1.751817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Warton, Remko Duursma, Daniel Falster, Sara Taskinen, Fonti Kar.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

